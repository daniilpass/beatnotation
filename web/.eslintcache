[{"E:\\Workspace\\git\\beat\\web\\src\\index.js":"1","E:\\Workspace\\git\\beat\\web\\src\\components\\app\\App.js":"2","E:\\Workspace\\git\\beat\\web\\src\\components\\noteList\\noteList.js":"3","E:\\Workspace\\git\\beat\\web\\src\\components\\track\\track.js":"4","E:\\Workspace\\git\\beat\\web\\src\\components\\track\\note.js":"5"},{"size":532,"mtime":1611669435888,"results":"6","hashOfConfig":"7"},{"size":9826,"mtime":1612095861203,"results":"8","hashOfConfig":"7"},{"size":14009,"mtime":1611927924608,"results":"9","hashOfConfig":"7"},{"size":1240,"mtime":1612095293830,"results":"10","hashOfConfig":"7"},{"size":955,"mtime":1612095062827,"results":"11","hashOfConfig":"7"},{"filePath":"12","messages":"13","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"14"},"1gmhed2",{"filePath":"15","messages":"16","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"17","messages":"18","errorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"19","usedDeprecatedRules":"14"},{"filePath":"20","messages":"21","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"22","messages":"23","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"E:\\Workspace\\git\\beat\\web\\src\\index.js",[],["24","25"],"E:\\Workspace\\git\\beat\\web\\src\\components\\app\\App.js",[],"E:\\Workspace\\git\\beat\\web\\src\\components\\noteList\\noteList.js",["26","27","28","29","30","31","32","33","34","35","36","37","38"],"import React from \"react\";\r\n\r\nclass CanvasNotes extends React.PureComponent {\r\n    constructor(props) {\r\n      super(props);\r\n  \r\n      this.canvas = null;\r\n      this.ctx = null;\r\n      this.cWidth = 1000;\r\n      this.cHeight = 800;\r\n      // Начало по X линии\r\n      this.startX = 20;\r\n      // Линии\r\n      this.lineWidth = 2;\r\n      this.linePadding = 10;\r\n      this.linesInGroupCount = 5;      \r\n      this.lineLength = this.cWidth - this.linePadding;\r\n      // Группы линий\r\n      this.groupsCount = 5;\r\n      this.groupsPadding = 40;\r\n      // Высота группы линий\r\n      this.lineGroupHeight = this.linesInGroupCount * (this.lineWidth  + this.linePadding) + this.groupsPadding;\r\n      this.delimiterHeight = (this.linesInGroupCount + 1) * (this.lineWidth  + this.linePadding);\r\n      // Ноты\r\n      this.noteRadius = 5;\r\n      \r\n      this.notesInTakt = 16;\r\n      this.notesInLine = this.notesInTakt * 3;\r\n      this.taktPadding = this.noteRadius * 10;\r\n    }\r\n  \r\n    componentDidMount() {\r\n      this.canvas = document.getElementById('canvas_notes');\r\n      this.ctx = this.canvas.getContext('2d');\r\n  \r\n      // this.drawHorizontalLine(10, 10, 400);\r\n      // this.drawLineSet(this.startX);\r\n      this.draw();\r\n      \r\n      this.lastNoteIndex = 0;\r\n    }\r\n  \r\n    draw(tracks, notesLimit) {\r\n      //console.log('Draw', tracks);\r\n      this.clear();\r\n      this.drawList(tracks, notesLimit);\r\n    }\r\n    \r\n    clear() {\r\n      this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n    \r\n    drawList(tracks, notesLimit) {\r\n      // Рисую сетку\r\n      for (let i = 1; i <= this.groupsCount; i++) {\r\n        this.drawLineSet(this.startX, this.lineGroupHeight  * i);   \r\n      }\r\n  \r\n      // Рисую ноты\r\n      if (tracks) {\r\n        \r\n  \r\n        let lineNumb = 1;\r\n        let lineNoteCounter = 1;\r\n        let taktNoteCounter = 1;\r\n        let taktCounter = 1;\r\n  \r\n  \r\n        // ГРаницы для соединения нот\r\n        let downBound = 999;\r\n        //let upperBound = -999;\r\n        let leftBound = 99;\r\n        let rightBound = -99;\r\n        let pattern = [0,0,0,0];\r\n        let pattern16 = false;\r\n        let pattern4 = false;\r\n        \r\n        let notesLength = notesLimit; //tracks[0].notes.length;\r\n        for (let noteIndex = 0; noteIndex < notesLength; noteIndex++) {\r\n          \r\n          // Координаты ноты по X\r\n          let note_x = this.startX + lineNoteCounter * (this.noteRadius * 2 + this.noteRadius) + taktCounter * this.taktPadding;\r\n          // Начало четверти\r\n          let lead4 = (noteIndex) % 4 == 0;\r\n          // Номер нижней ноты на линииях\r\n          let noteLine = -99;\r\n          // Сбросим границы при новом такте\r\n          if (lead4) {\r\n            downBound = 999;\r\n            //upperBound = -999;\r\n            leftBound = 99;\r\n            rightBound = -99;\r\n            pattern = [0,0,0,0];\r\n            pattern16 = false;\r\n            pattern4 = false;\r\n          }\r\n  \r\n          \r\n  \r\n          // Проходим по всем треках, рисуем ноты и если начало такта, то вычисляем границы нот в такте\r\n          for (let trackIndex = 0; trackIndex <  tracks.length; trackIndex++) {\r\n            let track = tracks[trackIndex];\r\n            let note = track.notes[noteIndex];\r\n            let line = track.line;\r\n            \r\n            // Вычисление границ и размера такта\r\n            if (lead4) {\r\n              //reset bounds            \r\n              let _leftBound=99;\r\n              _leftBound = track.notes[noteIndex + 3] > 0 ? noteIndex + 3 : _leftBound; \r\n              _leftBound = track.notes[noteIndex + 2] > 0 ? noteIndex + 2 : _leftBound;\r\n              _leftBound = track.notes[noteIndex + 1] > 0 ? noteIndex + 1 : _leftBound;\r\n              _leftBound = track.notes[noteIndex] > 0 ? noteIndex : _leftBound;\r\n  \r\n              let _rightBound=-99;\r\n              _rightBound = track.notes[noteIndex] > 0 ? _rightBound : _rightBound; \r\n              _rightBound = track.notes[noteIndex + 1] > 0 ? noteIndex + 1 : _rightBound;\r\n              _rightBound = track.notes[noteIndex + 2] > 0 ? noteIndex + 2 : _rightBound;\r\n              _rightBound = track.notes[noteIndex + 3] > 0 ? noteIndex +3 : _rightBound;\r\n  \r\n              leftBound = _leftBound < leftBound ? _leftBound : leftBound;\r\n              rightBound = _rightBound > rightBound ? _rightBound : rightBound;\r\n  \r\n              let _downBound = 999;\r\n              _downBound = track.notes[noteIndex + 3] > 0 ? track.line : _downBound; \r\n              _downBound = track.notes[noteIndex + 2] > 0 ? track.line : _downBound;\r\n              _downBound = track.notes[noteIndex + 1] > 0 ? track.line : _downBound;\r\n              _downBound = track.notes[noteIndex] > 0     ? track.line : _downBound;\r\n              downBound = _downBound < downBound? _downBound : downBound;\r\n  \r\n              //detect size\r\n              if (track.notes[noteIndex] > 0 ) {\r\n                pattern[0]=1;\r\n              }\r\n              if (track.notes[noteIndex+1] > 0 ) {\r\n                pattern[1]=1;\r\n              }\r\n              if (track.notes[noteIndex+2] > 0 ) {\r\n                pattern[2]=1;\r\n              }\r\n              if (track.notes[noteIndex+3] > 0 ) {\r\n                pattern[3]=1;\r\n              }\r\n            }\r\n  \r\n            // Если нота звучит, то рисуем её\r\n            if (note > 0) {\r\n              let _y = lineNumb * this.lineGroupHeight - this.linePadding/2 + line * this.linePadding\r\n              this.drawNote(note_x, _y, track.type);\r\n  \r\n              // Запоминаем самую верхнююю линию, на которой лежит нота\r\n              noteLine = line > noteLine ? line : noteLine;\r\n            }\r\n          }\r\n          \r\n          // Нормализую границы\r\n          leftBound = leftBound != 99 ? leftBound % 4 : leftBound;\r\n          rightBound = rightBound != -99 ? rightBound % 4 : rightBound ;\r\n  \r\n          // Вычисляю размер        \r\n          if (lead4 && !(pattern[0] === 1 && pattern[1] === 0 && pattern[2] === 1 && pattern[3] === 0) ) {\r\n            pattern16 = true;\r\n          }\r\n          if (lead4 && (pattern[0] === 1 && pattern[1] === 0 && pattern[2] === 0 && pattern[3] === 0)) {\r\n            pattern16 = false;\r\n            pattern4 = true;\r\n          }\r\n  \r\n          //Если размер 16 и нет ноты, то рисую паузу\r\n          if (pattern16 && noteLine == -99 && leftBound != 99 && rightBound !=-99) {\r\n            let pauseLine = 3;\r\n            let x = note_x;\r\n            let y = lineNumb * this.lineGroupHeight - this.linePadding/2 + pauseLine * this.linePadding\r\n            this.drawPause(x, y);\r\n          }\r\n  \r\n          // Подтягиваю нотные палки вверх        \r\n          if (noteLine != -99) {  \r\n              // Вертикальная линия\r\n              let x = note_x + this.noteRadius;\r\n              let y = lineNumb * this.lineGroupHeight - this.linePadding/2 + noteLine * this.linePadding;//- this.noteRadius*2;            \r\n              let length = (noteLine - downBound ) * (this.linePadding) + this.noteRadius*6;            \r\n  \r\n              // Если размер 16 и нота не первая и не последняя в группе, то рисую палочку покороче\r\n              let idx16 = noteIndex % 4;\r\n              if (pattern16 && idx16 != leftBound && idx16 != rightBound) {\r\n                length  = length - this.noteRadius;\r\n              }\r\n  \r\n              this.drawVerticalLine(x, y, -length);\r\n  \r\n              // Если онты обособлены, то рисую кончик 16 нот\r\n              if (pattern16 && leftBound == rightBound) {\r\n                this.drawNote16Tail(x - this.noteRadius, y - length + this.noteRadius * 2);\r\n              }\r\n          }\r\n  \r\n          // Рисую соеденительную линию\r\n          if (lead4 && leftBound != 99 && rightBound != -99) {\r\n            // Соеденительная линия размер 8\r\n            let x = note_x + this.noteRadius + leftBound* this.noteRadius * 3;\r\n            let y = lineNumb * this.lineGroupHeight - this.linePadding/2 + downBound * this.linePadding - this.noteRadius*6;\r\n            let length = (rightBound - leftBound) * this.noteRadius * 3; \r\n            this.drawHorizontalLine(x, y, length);\r\n  \r\n            // Дополнительная соеденительная линия для размера 16\r\n            if (pattern16) {\r\n              this.drawHorizontalLine(x, y + this.noteRadius, length);\r\n            }\r\n          }\r\n  \r\n          // Разделитель тактов\r\n          if (taktNoteCounter === this.notesInTakt) { \r\n            let _x = note_x + this.taktPadding/2 + this.noteRadius * 2 - this.noteRadius/2;\r\n            let _y = lineNumb * this.lineGroupHeight - this.linePadding/2;\r\n            this.drawVerticalLine(_x, _y, this.delimiterHeight);\r\n          }\r\n  \r\n          // Считаю ноты в линии и такте\r\n          lineNoteCounter = lineNoteCounter + 1;\r\n          taktNoteCounter = taktNoteCounter + 1;\r\n  \r\n          // Если нот достаточно, то перехожу на новые строчки в листе и сбрасываю линейные счетчики\r\n          if (lineNoteCounter > this.notesInLine){\r\n            lineNoteCounter = 1;\r\n            taktCounter = 1;\r\n            taktNoteCounter = 1;  \r\n            lineNumb = lineNumb + 1;\r\n          }\r\n  \r\n          // Если такт полный, то увеличиваю счетчики такта и сбрасываю  счетчик нот в такте\r\n          if (taktNoteCounter > this.notesInTakt) {   \r\n            taktCounter = taktCounter + 1;\r\n            taktNoteCounter = 1;\r\n          }\r\n  \r\n          // Для дебага рисую меньше нот\r\n          //if (lineNoteCounter > 4)        return;\r\n        }\r\n        \r\n      }\r\n    }\r\n  \r\n    // Задачет цвет и толщину\r\n    setCanvasStyle(color, width) {\r\n      this.ctx.fillStyle = color;\r\n      this.ctx.strokeStyle = color;\r\n      this.ctx.lineWidth = width;\r\n    }\r\n  \r\n    // Рисует паузу\r\n    drawPause(posX, posY) {\r\n      this.setCanvasStyle(\"#a1a1a1\", 1.1);\r\n      \r\n      let pauseRadius = this.noteRadius / 2;\r\n  \r\n      this.ctx.beginPath();\r\n      this.ctx.arc(posX + pauseRadius, posY, pauseRadius, 0, 2 * Math.PI);\r\n      this.ctx.fill();\r\n      this.ctx.arc(posX, posY + pauseRadius * 5, pauseRadius, 0, 2 * Math.PI);\r\n      this.ctx.fill();\r\n      this.ctx.moveTo(posX + pauseRadius*2, posY - pauseRadius*2);\r\n      this.ctx.lineTo(posX + pauseRadius, posY + pauseRadius * 10);    \r\n      this.ctx.stroke();\r\n    }\r\n  \r\n    // Рисует ноту\r\n    drawNote(posX, posY, type) {\r\n      this.setCanvasStyle(\"#000000\", 1.1);\r\n  \r\n      if (type === 2 || type === 3) {\r\n        // X-type notes\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(posX - this.noteRadius, posY - this.noteRadius);\r\n        this.ctx.lineTo(posX + this.noteRadius, posY + this.noteRadius);\r\n        this.ctx.stroke();\r\n        this.ctx.moveTo(posX + this.noteRadius, posY - this.noteRadius);\r\n        this.ctx.lineTo(posX - this.noteRadius, posY + this.noteRadius);\r\n        this.ctx.stroke();\r\n      } else {\r\n        //  Default note\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(posX, posY, this.noteRadius, 0, 2 * Math.PI);\r\n        this.ctx.fill();\r\n      }\r\n      \r\n      this.drawNoteTail(posX, posY, type);\r\n    }\r\n  \r\n    // Рисует кончик для 16х нот\r\n    drawNote16Tail (posX, posY) {\r\n      this.setCanvasStyle(\"#000000\", 1.1);\r\n      this.ctx.beginPath();      \r\n      this.ctx.moveTo(posX + this.noteRadius, posY - this.noteRadius);\r\n      this.ctx.lineTo(posX + this.noteRadius*2, posY);\r\n      this.ctx.moveTo(posX + this.noteRadius, posY - this.noteRadius * 2);\r\n      this.ctx.lineTo(posX + this.noteRadius*2, posY- this.noteRadius);\r\n      this.ctx.stroke();\r\n  \r\n    }\r\n  \r\n    // рисует особые кончики\r\n    drawNoteTail(posX, posY, type) {\r\n      this.setCanvasStyle(\"#000000\", 1.1);\r\n  \r\n       // Кружок для открытого Hi-Hat's\r\n       if (type === 3) {\r\n        // Draw o\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(posX, posY - this.noteRadius*4, this.noteRadius/2, 0, 2 * Math.PI);\r\n        this.ctx.stroke();\r\n      } \r\n    }\r\n  \r\n    // Разделитель тактов\r\n    // drawTaktDelimiter(x, y, length) {\r\n    //   this.setCanvasStyle(\"#000000\", 1.1);\r\n  \r\n    //   this.ctx.beginPath();\r\n    //   this.ctx.moveTo(x, y);\r\n    //   this.ctx.lineTo(x, length);\r\n    //   this.ctx.stroke();\r\n    // }\r\n  \r\n    // Рисует группу линий\r\n    drawLineSet(startX, startY) {\r\n      for (let i = 1; i <= this.linesInGroupCount ; i++) {\r\n        this.drawHorizontalLine(startX, startY + i * this.linePadding, this.lineLength);    \r\n      }\r\n    }\r\n  \r\n    // Вертикальная линия\r\n    drawHorizontalLine(x, y, length) {\r\n      this.setCanvasStyle(\"#000000\", 1.1);\r\n  \r\n      this.ctx.beginPath();\r\n      this.ctx.moveTo(x, y);\r\n      this.ctx.lineTo(x + length, y);\r\n      this.ctx.stroke();\r\n    }\r\n  \r\n    // Горизонтальная линия\r\n    drawVerticalLine(x, y, length) {\r\n      this.setCanvasStyle(\"#000000\", 1.1);\r\n  \r\n      this.ctx.beginPath();\r\n      this.ctx.moveTo(x, y);\r\n      this.ctx.lineTo(x, y + length);\r\n      this.ctx.stroke();\r\n    }\r\n  \r\n    render() {\r\n      return <canvas id=\"canvas_notes\" width={this.cWidth} height={this.cHeight}></canvas>\r\n    }\r\n}\r\n\r\n  \r\nexport default CanvasNotes;","E:\\Workspace\\git\\beat\\web\\src\\components\\track\\track.js",[],"E:\\Workspace\\git\\beat\\web\\src\\components\\track\\note.js",[],{"ruleId":"39","replacedBy":"40"},{"ruleId":"41","replacedBy":"42"},{"ruleId":"43","severity":1,"message":"44","line":84,"column":39,"nodeType":"45","messageId":"46","endLine":84,"endColumn":41},{"ruleId":"43","severity":1,"message":"47","line":157,"column":33,"nodeType":"45","messageId":"46","endLine":157,"endColumn":35},{"ruleId":"43","severity":1,"message":"47","line":158,"column":35,"nodeType":"45","messageId":"46","endLine":158,"endColumn":37},{"ruleId":"48","severity":1,"message":"49","line":166,"column":13,"nodeType":"50","messageId":"51","endLine":166,"endColumn":21},{"ruleId":"43","severity":1,"message":"44","line":170,"column":37,"nodeType":"45","messageId":"46","endLine":170,"endColumn":39},{"ruleId":"43","severity":1,"message":"47","line":170,"column":57,"nodeType":"45","messageId":"46","endLine":170,"endColumn":59},{"ruleId":"43","severity":1,"message":"47","line":170,"column":77,"nodeType":"45","messageId":"46","endLine":170,"endColumn":79},{"ruleId":"43","severity":1,"message":"47","line":178,"column":24,"nodeType":"45","messageId":"46","endLine":178,"endColumn":26},{"ruleId":"43","severity":1,"message":"47","line":186,"column":38,"nodeType":"45","messageId":"46","endLine":186,"endColumn":40},{"ruleId":"43","severity":1,"message":"47","line":186,"column":60,"nodeType":"45","messageId":"46","endLine":186,"endColumn":62},{"ruleId":"43","severity":1,"message":"44","line":193,"column":42,"nodeType":"45","messageId":"46","endLine":193,"endColumn":44},{"ruleId":"43","severity":1,"message":"47","line":199,"column":34,"nodeType":"45","messageId":"46","endLine":199,"endColumn":36},{"ruleId":"43","severity":1,"message":"47","line":199,"column":54,"nodeType":"45","messageId":"46","endLine":199,"endColumn":56},"no-native-reassign",["52"],"no-negated-in-lhs",["53"],"eqeqeq","Expected '===' and instead saw '=='.","BinaryExpression","unexpected","Expected '!==' and instead saw '!='.","no-unused-vars","'pattern4' is assigned a value but never used.","Identifier","unusedVar","no-global-assign","no-unsafe-negation"]